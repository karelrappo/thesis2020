---
title: "data_cleaning"
author: "Karel RÃ¤pp, Henry Enno Turu"
date: "29 11 2020"
output: 
  bookdown::pdf_document2:
    toc: no
csl: apa.csl
bibliography: library.bib
indent: yes
fontsize: 12pt
geometry: margin = 1in
link-citations: yes
linkcolor: blue
urlcolor: blue
header-includes:
- \usepackage{placeins}
- \usepackage{setspace}
- \usepackage{chngcntr}
- \usepackage{microtype}
- \counterwithin{figure}{section}
- \counterwithin{table}{section}
- \usepackage{float}
- \usepackage{amsmath}
- \DeclareMathOperator{\logit}{logit}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(stringr)
library(tidyverse)
library(summarytools)
library(kableExtra)
library(dynlm)
library(stats)
library(readr)
library(dplyr)
library(ggplot2)
library(data.table)
library(MacroRF)
require(data.table)
library(zoo)
```

```{r Import Data, include=F}
df <- read_csv("data/gdp_yiv.csv")
df$Date <- as.Date(df$Date, format="%d.%m.%Y")

dependent<- read_csv("data/dependent.csv")#Dependent variables
dependent$DATE <- as.Date(dependent$DATE, origin = "1899-12-30")

feds <- read_csv("data/feds.csv") #fed rates dataset


housng <- read_csv("data/HOUSNG.csv")
housng$DATE <- as.Date(housng$DATE, format="%d.%m.%Y")


vixcurrent <- read_csv("data/vixcurrent.csv") #Current VIX methodology
vixarchive <- read_csv("data/vixarchive.csv") #Current applied retrospectively

vixcurrent$Date <- as.Date(vixcurrent$Date, format="%m/%d/%Y")
vixarchive$Date <- as.Date(vixarchive$Date, format="%d.%m.%Y")

vix <-rbind(vixarchive, vixcurrent)

DATE1 <- c(as.Date("01/01/2016",format="%d/%m/%Y"))
vix <- subset(vix, Date<=DATE1) #Daily data

vix <- vix %>%
  select(VIX='VIX Close', 'Date')

vix <- vix %>%
  mutate(month=month(Date)) %>%
    mutate(year=year(Date))
  
vix_monthly <- aggregate(VIX ~ month + year, vix, mean)

vix_monthly <- vix_monthly  %>%
  mutate(DATE=as.Date(paste(year,month,"01", sep="/"))) %>%
  select(-month, -year)

#Bind together so everything in one place, e.g. one dataset for monthly data, one for quarterly
monthly <- merge(housng, dependent, by="DATE")
monthly <- merge(monthly, vix_monthly, by="DATE")

dummy <- read.csv("Dummy.csv")

df <- df %>%
  mutate(dum = dummy$Reccession)

df.expansionary <- subset(df, dum== 0)
df.recessionary <- subset(df, dum== 1)


```




